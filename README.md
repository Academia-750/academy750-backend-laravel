## Academia 750 API (BACKEND)

Academia 750 is an organization for the comprehensive preparation of oppositions to
Firefighters from the different Autonomous Communities of Spain.
It currently has social networks for the dissemination of its services and does not have
with a web presence as an official means of communication, likewise, it does not have
with a platform for the training of its students for the modalities
face-to-face and online


### User Credentials

* ```Default User``` (Generated by seed)
  * **Admin**
    * DNI: ***74237694L***
    * Password: ***academia750***

### Install the project

- Get PHP 8.2 
- Get Composer 2
- Get Node v16.20.1 and Yarn

`composer install` 

If something fails install the php required extensions.

### Api Documentation

We are using  [Scribe](https://scribe.knuckles.wtf/laravel/). 
Scribe does most of the job we take care of:

1 - Requests: Add the bodyParameters or the queryParameters function.
2 - Resources: Add the Resource/ResourceCollection response to allow scribe deduce the autoput.
3 - In the controller add (if required) the @authenticated, @urlParam for url parameters and other HTTP status scenarios.
4 - The models are taken from the Factories. Using create from another factory inside our factory wont work for doc, you can add 
` config('app.env') === 'documentation'` check for this specific scenarios.

Update the documentation running `APP_ENV=documentation php artisan scribe:generate php artisan scribe:generate` or `yarn doc`

### Set Up the database

1 - Install MYSQL

2 - Create the tables for the database (and test database if required)

3 - Create a user and grand him access 

```
mysql -u root
CREATE DATABASE bomberosapimysql;
CREATE USER 'bomberos'@'localhost' IDENTIFIED WITH mysql_native_password BY '123456';
GRANT ALL ON `bomberosapimysql`.* TO `bomberos`@`localhost`;
```


3 - Run the migrations 

> php artisan migrate   

4 - Run the Seeder (To get the super admin access as well as the roles permissions)

> php artisan db:seed

## Run locally

> yarn serve 
## Server Installation

[Notion Guide](https://www.notion.so/tianlu/Academy-750-Code-Base-5833b818639448cea5607f6a7fa86ee5?pvs=4)


### Sentry

If you have PHP 8.1.0 and you can not do

`php artisan sentry:test` 

getting the error

```
There was an error sending the event.
SDK: Failed to send the event to Sentry. Reason: "HTTP/2 stream 1 was reset for "https://o4505596447162368.ingest.sentry.io/api/4505596448210944/store/".".
Please check the error message from the SDK above for further hints about what went wrong.
```

Is due a problem with PHP CURL with sentry, you can reinstall sentry this way

composer update -W sentry/sentry-laravel

## Desarrolladores (Phase 1)

* ___Ra√∫l Alberto Moheno Zavaleta___
* Adolfo Feria
* Carlos Herrera

## Desarrolladores (Phase 2)
* Abel Bordonado Lillo
